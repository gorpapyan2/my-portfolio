import{c as b,u as D,l as T,r as n,j as e,T as v,p as L}from"./index-BwUXuwsi.js";import{P as j,T as q}from"./trash-2-8LGwtqhK.js";import{I as F}from"./ImageUpload-C8BLs-0y.js";import{S as K}from"./square-pen-Nci9-J-k.js";import"./upload-X1QddCHZ.js";const U=b("StarOff",[["path",{d:"M8.34 8.34 2 9.27l5 4.87L5.82 21 12 17.77 18.18 21l-.59-3.43",key:"16m0ql"}],["path",{d:"M18.42 12.76 22 9.27l-6.91-1L12 2l-1.44 2.91",key:"1vt8nq"}],["line",{x1:"2",x2:"22",y1:"2",y2:"22",key:"a6p6uj"}]]);const M=b("Star",[["polygon",{points:"12 2 15.09 8.26 22 9.27 17 14.14 18.18 21.02 12 17.77 5.82 21.02 7 14.14 2 9.27 8.91 8.26 12 2",key:"8f66p6"}]]);function z({onClose:N}){const{t:s}=D(),{projects:h,isLoading:y,createProject:_,updateProject:w,deleteProject:S}=T(),[k,d]=n.useState(!1),[x,u]=n.useState(null),[a,l]=n.useState({title:"",description:"",image:"",tags:[],live_url:"",github_url:"",order_index:0,featured:!1}),[i,f]=n.useState({}),[c,o]=n.useState(""),C=async t=>{t.preventDefault(),f({});try{const r=L.parse(a);x?await w(x.id,r):await _(r),d(!1),u(null),l({title:"",description:"",image:"",tags:[],live_url:"",github_url:"",order_index:0,featured:!1}),o("")}catch(r){if(r instanceof Error&&"issues"in r){const m={};r.issues.forEach(g=>{m[g.path[0]]=g.message}),f(m)}}},E=t=>{u(t),l({title:t.title,description:t.description,image:t.image||"",tags:t.tags,live_url:t.live_url||"",github_url:t.github_url||"",order_index:t.order_index,featured:t.featured}),d(!0)},P=async t=>{if(confirm(s("admin.projects.confirm.delete")))try{await S(t)}catch(r){console.error("Error deleting project:",r),alert(s("admin.projects.error.deleteFailed"))}},p=()=>{c.trim()&&!a.tags?.includes(c.trim())&&(l({...a,tags:[...a.tags||[],c.trim()]}),o(""))},I=t=>{l({...a,tags:a.tags?.filter(r=>r!==t)||[]})};return y?e.jsx("div",{className:"flex items-center justify-center py-8",children:e.jsx("div",{className:"text-[var(--text)]",children:e.jsx(v,{translationKey:"admin.common.loading",as:"span",shimmerWidth:"100px"})})}):e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsx("h2",{className:"text-[length:var(--font-600)] font-semibold text-[var(--text)]",children:e.jsx(v,{translationKey:"admin.projects.title",as:"span",shimmerWidth:"200px"})}),e.jsx("button",{onClick:N,className:"p-2 text-[var(--text-muted)] hover:text-[var(--text)] transition-colors","aria-label":s("admin.common.close"),children:"×"})]}),k?e.jsxs("form",{onSubmit:C,className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"form-label",children:s("admin.common.title")}),e.jsx("input",{type:"text",value:a.title,onChange:t=>l({...a,title:t.target.value}),className:`field ${i.title?"border-red-500":"border-[var(--border)]"}`,required:!0}),i.title&&e.jsx("p",{className:"text-red-400 text-[length:var(--font-100)] mt-1",children:i.title})]}),e.jsxs("div",{children:[e.jsx("label",{className:"form-label",children:s("admin.common.orderIndex")}),e.jsx("input",{type:"number",value:a.order_index,onChange:t=>l({...a,order_index:parseInt(t.target.value)||0}),className:"field",min:"0"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"form-label",children:s("admin.common.description")}),e.jsx("textarea",{value:a.description,onChange:t=>l({...a,description:t.target.value}),rows:4,className:`field ${i.description?"border-red-500":"border-[var(--border)]"}`,required:!0}),i.description&&e.jsx("p",{className:"text-red-400 text-[length:var(--font-100)] mt-1",children:i.description})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsx("div",{children:e.jsx(F,{currentImage:a.image||"",onImageChange:t=>l({...a,image:t}),folder:"projects"})}),e.jsxs("div",{children:[e.jsx("label",{className:"form-label",children:s("admin.projects.form.liveUrl")}),e.jsx("input",{type:"url",value:a.live_url||"",onChange:t=>l({...a,live_url:t.target.value}),className:"field"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"form-label",children:s("admin.projects.form.githubUrl")}),e.jsx("input",{type:"url",value:a.github_url||"",onChange:t=>l({...a,github_url:t.target.value}),className:"field"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"form-label",children:s("admin.projects.form.tags")}),e.jsxs("div",{className:"flex gap-2 mb-2",children:[e.jsx("input",{type:"text",value:c,onChange:t=>o(t.target.value),onKeyPress:t=>t.key==="Enter"&&(t.preventDefault(),p()),className:"flex-1 field",placeholder:s("admin.projects.form.tagPlaceholder")}),e.jsx("button",{type:"button",onClick:p,className:"btn btn-primary",children:s("admin.common.add")})]}),e.jsx("div",{className:"flex flex-wrap gap-2",children:a.tags?.map((t,r)=>e.jsxs("span",{className:"inline-flex items-center gap-1 px-3 py-1 bg-[var(--surface-strong)] text-[var(--text)] rounded-full text-[length:var(--font-100)]",children:[t,e.jsx("button",{type:"button",onClick:()=>I(t),className:"text-[var(--text-muted)] hover:text-[var(--text)]",children:"×"})]},r))}),i.tags&&e.jsx("p",{className:"text-red-400 text-[length:var(--font-100)] mt-1",children:i.tags})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("input",{type:"checkbox",id:"featured",checked:a.featured,onChange:t=>l({...a,featured:t.target.checked}),className:"rounded"}),e.jsx("label",{htmlFor:"featured",className:"text-[var(--text-muted)]",children:s("admin.projects.form.featured")})]}),e.jsxs("div",{className:"flex items-center justify-end gap-3 pt-4",children:[e.jsx("button",{type:"button",onClick:()=>{d(!1),u(null),l({title:"",description:"",image:"",tags:[],live_url:"",github_url:"",order_index:0,featured:!1}),o("")},className:"btn btn-secondary",children:s("admin.common.cancel")}),e.jsxs("button",{type:"submit",className:"inline-flex items-center gap-2 btn btn-primary",children:[e.jsx(j,{className:"h-4 w-4"}),s(x?"admin.projects.button.update":"admin.projects.button.create")]})]})]}):e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsxs("h3",{className:"text-[length:var(--font-400)] font-medium text-[var(--text)]",children:[s("admin.projects.section.title")," (",h.length,")"]}),e.jsxs("button",{onClick:()=>d(!0),className:"inline-flex items-center gap-2 btn btn-primary",children:[e.jsx(j,{className:"h-4 w-4"}),s("admin.projects.button.add")]})]}),e.jsx("div",{className:"space-y-4",children:h.map(t=>e.jsx("div",{className:"p-4 bg-[var(--surface)] rounded-[var(--radius-md)] border border-[var(--border)]",children:e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx("h4",{className:"text-[length:var(--font-400)] font-medium text-[var(--text)]",children:t.title}),t.featured?e.jsx(M,{className:"h-4 w-4 text-yellow-400"}):e.jsx(U,{className:"h-4 w-4 text-[var(--text-muted)]"})]}),e.jsx("p",{className:"text-[var(--text-muted)] text-[length:var(--font-100)] mb-2",children:t.description}),e.jsxs("div",{className:"flex items-center gap-4 text-[length:var(--font-100)] text-[var(--text-muted)] mb-2",children:[e.jsxs("span",{children:[s("admin.projects.card.order")," ",t.order_index]}),e.jsxs("span",{children:[s("admin.projects.card.created")," ",new Date(t.created_at).toLocaleDateString()]})]}),e.jsx("div",{className:"flex flex-wrap gap-1",children:t.tags.map((r,m)=>e.jsx("span",{className:"px-2 py-1 bg-[var(--surface-strong)] text-[var(--text)] rounded text-[length:var(--font-100)]",children:r},m))})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("button",{onClick:()=>E(t),className:"p-2 text-[var(--text-muted)] hover:text-[var(--text)] transition-colors",children:e.jsx(K,{className:"h-4 w-4"})}),e.jsx("button",{onClick:()=>P(t.id),className:"p-2 text-[var(--text-muted)] hover:text-red-400 transition-colors",children:e.jsx(q,{className:"h-4 w-4"})})]})]})},t.id))})]})]})}export{z as ProjectAdmin};
