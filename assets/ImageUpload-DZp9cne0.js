import{c as W,u as _,r as n,j as e,X as C,T as i,s as y}from"./index-DiO0CGqv.js";import{U as G}from"./upload-BlF5G2Pg.js";const K=W("Loader",[["line",{x1:"12",x2:"12",y1:"2",y2:"6",key:"gza1u7"}],["line",{x1:"12",x2:"12",y1:"18",y2:"22",key:"1qhbu9"}],["line",{x1:"4.93",x2:"7.76",y1:"4.93",y2:"7.76",key:"xae44r"}],["line",{x1:"16.24",x2:"19.07",y1:"16.24",y2:"19.07",key:"bxnmvf"}],["line",{x1:"2",x2:"6",y1:"12",y2:"12",key:"89khin"}],["line",{x1:"18",x2:"22",y1:"12",y2:"12",key:"pb8tfm"}],["line",{x1:"4.93",x2:"7.76",y1:"19.07",y2:"16.24",key:"1uxjnu"}],["line",{x1:"16.24",x2:"19.07",y1:"7.76",y2:"4.93",key:"6duxfx"}]]),j="images",M="blog-images",z=5*1024*1024,E=["image/jpeg","image/png","image/gif","image/webp"];function X({onUpload:N,onImageChange:u,currentImage:l,folder:U,disabled:m=!1}){const{t:k}=_(),[s,x]=n.useState(!1),[g,t]=n.useState(null),[v,c]=n.useState(null),o=n.useRef(null),F=U??M;n.useEffect(()=>{l&&c(l)},[l]);const w=a=>E.includes(a.type)?a.size>z?`File size must be less than 5MB. Got ${(a.size/1024/1024).toFixed(2)}MB`:null:`File type must be JPEG, PNG, GIF, or WebP. Got ${a.type}`,f=async a=>{try{x(!0),t(null);const r=w(a);if(r){t(r);return}const $=Date.now(),R=Math.random().toString(36).substring(2,8),S=a.name.split(".").pop()||"jpg",A=`${$}-${R}.${S}`,d=`${F}/${A}`,{error:h}=await y.storage.from(j).upload(d,a,{cacheControl:"3600",upsert:!1});if(h){t(`Upload failed: ${h.message}`);return}const{data:p}=y.storage.from(j).getPublicUrl(d);if(!p?.publicUrl){t("Failed to get public URL");return}const b=new FileReader;b.onload=I=>{c(I.target?.result)},b.readAsDataURL(a),N?.(p.publicUrl,a.name.replace(/\.[^/.]+$/,""),d),u?.(p.publicUrl)}catch(r){console.error("Error uploading image:",r),t(r instanceof Error?r.message:"Failed to upload image")}finally{x(!1)}},D=a=>{const r=a.currentTarget.files?.[0];r&&f(r)},L=a=>{a.preventDefault(),a.stopPropagation()},P=a=>{a.preventDefault(),a.stopPropagation();const r=a.dataTransfer.files?.[0];r&&f(r)},T=()=>{c(null),t(null),o.current&&(o.current.value=""),u?.("")};return e.jsxs("div",{className:"stack [--stack-space:var(--space-12)]",children:[g&&e.jsx("div",{className:"p-[var(--space-12)] bg-red-500/10 border border-red-500/20 rounded-[var(--radius-md)] text-red-400 text-[length:var(--font-100)]",children:g}),v&&e.jsxs("div",{className:"relative inline-block",children:[e.jsx("img",{src:v,alt:"Preview",className:"max-w-xs h-auto rounded-[var(--radius-md)] border border-[var(--border)]"}),e.jsx("button",{onClick:T,disabled:s,className:"absolute top-[var(--space-8)] right-[var(--space-8)] p-[var(--space-8)] bg-red-500 hover:bg-red-600 text-white rounded-[var(--radius-sm)] transition-colors disabled:opacity-50",title:k("admin.imageUpload.removePreview"),children:e.jsx(C,{className:"h-[var(--space-16)] w-[var(--space-16)]"})})]}),e.jsxs("div",{onDragOver:L,onDrop:P,onClick:()=>!s&&o.current?.click(),className:`
          border-2 border-dashed rounded-[var(--radius-md)] p-[var(--space-24)] text-center transition-colors cursor-pointer
          ${s||m?"border-[var(--text-muted)]/50 bg-[var(--surface-strong)] cursor-not-allowed opacity-50":"border-[var(--border)] bg-[var(--surface)] hover:bg-[var(--surface-strong)] hover:border-[var(--border)]/70"}
        `,children:[e.jsx("input",{ref:o,type:"file",accept:E.join(","),onChange:D,disabled:s||m,className:"hidden"}),e.jsx("div",{className:"flex flex-col items-center gap-[var(--space-8)]",children:s?e.jsxs(e.Fragment,{children:[e.jsx(K,{className:"h-[var(--space-32)] w-[var(--space-32)] text-accent animate-spin"}),e.jsx("p",{className:"text-[length:var(--font-100)] text-[var(--text-muted)]",children:e.jsx(i,{translationKey:"admin.imageUpload.uploading",as:"span",shimmerWidth:"100px"})})]}):e.jsxs(e.Fragment,{children:[e.jsx(G,{className:"h-[var(--space-32)] w-[var(--space-32)] text-[var(--text-muted)]"}),e.jsx("p",{className:"text-[length:var(--font-100)] text-[var(--text)] font-medium",children:e.jsx(i,{translationKey:"admin.imageUpload.dragDrop",as:"span",shimmerWidth:"250px"})}),e.jsx("p",{className:"text-[length:var(--font-100)] text-[var(--text-muted)]",children:e.jsx(i,{translationKey:"admin.imageUpload.fileTypes",as:"span",shimmerWidth:"250px"})})]})})]}),e.jsx("p",{className:"text-[length:var(--font-100)] text-[var(--text-muted)]",children:e.jsx(i,{translationKey:"admin.imageUpload.uploadInfo",as:"span",shimmerWidth:"400px"})})]})}export{X as I};
