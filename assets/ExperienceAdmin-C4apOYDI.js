import{u as L,r as l,q as T,j as e,T as g,t as I}from"./index-BwUXuwsi.js";import{P as N,T as $}from"./trash-2-8LGwtqhK.js";import{S as F}from"./square-pen-Nci9-J-k.js";function z({onClose:y}){const{t:a,language:E}=L(),[d,u]=l.useState(E),{experiences:v,isLoading:w,createExperience:C,updateExperience:S,deleteExperience:_}=T({language:d}),[k,c]=l.useState(!1),[h,p]=l.useState(null),[r,i]=l.useState({role:"",company:"",period:"",description:"",achievements:[],order_index:0}),[n,j]=l.useState({}),[o,m]=l.useState(""),D=async t=>{t.preventDefault(),j({});try{const s=I.parse(r);h?await S(h.id,s,d):await C(s,d),c(!1),p(null),i({role:"",company:"",period:"",description:"",achievements:[],order_index:0}),m("")}catch(s){if(s instanceof Error&&"issues"in s){const x={};s.issues.forEach(b=>{x[b.path[0]]=b.message}),j(x)}}},A=t=>{p(t),i({role:t.role,company:t.company,period:t.period,description:t.description,achievements:t.achievements,order_index:t.order_index}),c(!0)},q=async t=>{if(confirm(a("admin.experience.confirm.delete")))try{await _(t)}catch(s){console.error("Error deleting experience:",s),alert(a("admin.experience.error.deleteFailed"))}},f=()=>{o.trim()&&!r.achievements?.includes(o.trim())&&(i({...r,achievements:[...r.achievements||[],o.trim()]}),m(""))},P=t=>{i({...r,achievements:r.achievements?.filter(s=>s!==t)||[]})};return w?e.jsx("div",{className:"flex items-center justify-center py-8",children:e.jsx(g,{translationKey:"admin.common.loading",as:"div",shimmerWidth:"100px",className:"text-[var(--text)]"})}):e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsx("h2",{className:"text-[length:var(--font-600)] font-semibold text-[var(--text)]",children:e.jsx(g,{translationKey:"admin.experience.title",as:"span",shimmerWidth:"230px"})}),e.jsx("button",{onClick:y,className:"p-2 text-[var(--text-muted)] hover:text-[var(--text)] transition-colors",children:"×"})]}),k?e.jsxs("form",{onSubmit:D,className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"form-label",children:a("admin.common.language")}),e.jsxs("select",{value:d,onChange:t=>u(t.target.value),className:"field",children:[e.jsx("option",{value:"en",children:"English"}),e.jsx("option",{value:"ru",children:"Russian"}),e.jsx("option",{value:"am",children:"Armenian"})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"form-label",children:a("admin.experience.form.role")}),e.jsx("input",{type:"text",value:r.role,onChange:t=>i({...r,role:t.target.value}),className:`field ${n.role?"border-red-500":"border-[var(--border)]"}`,required:!0}),n.role&&e.jsx("p",{className:"text-red-400 text-[length:var(--font-100)] mt-1",children:n.role})]}),e.jsxs("div",{children:[e.jsx("label",{className:"form-label",children:a("admin.experience.form.company")}),e.jsx("input",{type:"text",value:r.company,onChange:t=>i({...r,company:t.target.value}),className:`field ${n.company?"border-red-500":"border-[var(--border)]"}`,required:!0}),n.company&&e.jsx("p",{className:"text-red-400 text-[length:var(--font-100)] mt-1",children:n.company})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"form-label",children:a("admin.experience.form.period")}),e.jsx("input",{type:"text",value:r.period,onChange:t=>i({...r,period:t.target.value}),className:`field ${n.period?"border-red-500":"border-[var(--border)]"}`,placeholder:a("admin.experience.periodPlaceholder"),required:!0}),n.period&&e.jsx("p",{className:"text-red-400 text-[length:var(--font-100)] mt-1",children:n.period})]}),e.jsxs("div",{children:[e.jsx("label",{className:"form-label",children:a("admin.common.description")}),e.jsx("textarea",{value:r.description,onChange:t=>i({...r,description:t.target.value}),rows:3,className:`field ${n.description?"border-red-500":"border-[var(--border)]"}`,required:!0}),n.description&&e.jsx("p",{className:"text-red-400 text-[length:var(--font-100)] mt-1",children:n.description})]}),e.jsxs("div",{children:[e.jsx("label",{className:"form-label",children:a("admin.experience.form.achievements")}),e.jsxs("div",{className:"flex gap-2 mb-2",children:[e.jsx("input",{type:"text",value:o,onChange:t=>m(t.target.value),onKeyPress:t=>t.key==="Enter"&&(t.preventDefault(),f()),className:"flex-1 field",placeholder:a("admin.experience.form.achievementPlaceholder")}),e.jsx("button",{type:"button",onClick:f,className:"btn btn-primary",children:a("admin.common.add")})]}),e.jsx("div",{className:"space-y-2",children:r.achievements?.map((t,s)=>e.jsxs("div",{className:"flex items-center justify-between p-2 bg-[var(--surface)] rounded-[var(--radius-md)]",children:[e.jsx("span",{className:"text-[var(--text)] text-[length:var(--font-100)]",children:t}),e.jsx("button",{type:"button",onClick:()=>P(t),className:"text-[var(--text-muted)] hover:text-red-400",children:"×"})]},s))})]}),e.jsxs("div",{children:[e.jsx("label",{className:"form-label",children:a("admin.common.orderIndex")}),e.jsx("input",{type:"number",value:r.order_index,onChange:t=>i({...r,order_index:parseInt(t.target.value)||0}),className:"field",min:"0"})]}),e.jsxs("div",{className:"flex items-center justify-end gap-3 pt-4",children:[e.jsx("button",{type:"button",onClick:()=>{c(!1),p(null),i({role:"",company:"",period:"",description:"",achievements:[],order_index:0}),m("")},className:"btn btn-secondary",children:a("admin.common.cancel")}),e.jsxs("button",{type:"submit",className:"inline-flex items-center gap-2 btn btn-primary",children:[e.jsx(N,{className:"h-4 w-4"}),a(h?"admin.experience.button.update":"admin.experience.button.create")]})]})]}):e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"flex flex-wrap items-center justify-between gap-3 mb-6",children:[e.jsxs("h3",{className:"text-[length:var(--font-400)] font-medium text-[var(--text)]",children:[a("admin.experience.titleCount")," (",v.length,")"]}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsxs("select",{value:d,onChange:t=>u(t.target.value),className:"field",children:[e.jsx("option",{value:"en",children:"English"}),e.jsx("option",{value:"ru",children:"Russian"}),e.jsx("option",{value:"am",children:"Armenian"})]}),e.jsxs("button",{onClick:()=>c(!0),className:"inline-flex items-center gap-2 btn btn-primary",children:[e.jsx(N,{className:"h-4 w-4"}),a("admin.experience.addExperience")]})]})]}),e.jsx("div",{className:"space-y-4",children:v.map(t=>e.jsx("div",{className:"p-4 bg-[var(--surface)] rounded-[var(--radius-md)] border border-[var(--border)]",children:e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{className:"flex-1",children:[e.jsxs("h4",{className:"text-[length:var(--font-400)] font-medium text-[var(--text)] mb-2",children:[t.role," ",a("admin.experience.card.at")," ",t.company]}),e.jsx("p",{className:"text-[var(--text-muted)] text-[length:var(--font-100)] mb-2",children:t.period}),e.jsx("p",{className:"text-[var(--text-muted)] mb-3",children:t.description}),e.jsx("div",{className:"space-y-1",children:t.achievements.map((s,x)=>e.jsxs("div",{className:"text-[length:var(--font-100)] text-[var(--text-muted)]",children:["• ",s]},x))}),e.jsxs("div",{className:"text-[length:var(--font-100)] text-[var(--text-muted)] mt-2",children:[a("admin.experience.card.order")," ",t.order_index," | ",a("admin.experience.card.created")," ",new Date(t.created_at).toLocaleDateString()]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("button",{onClick:()=>A(t),className:"p-2 text-[var(--text-muted)] hover:text-[var(--text)] transition-colors",children:e.jsx(F,{className:"h-4 w-4"})}),e.jsx("button",{onClick:()=>q(t.id),className:"p-2 text-[var(--text-muted)] hover:text-red-400 transition-colors",children:e.jsx($,{className:"h-4 w-4"})})]})]})},t.id))})]})]})}export{z as ExperienceAdmin};
