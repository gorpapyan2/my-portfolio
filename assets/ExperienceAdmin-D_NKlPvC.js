import{u as I,r as u,j as e,T}from"./index-siMbvs9L.js";import{T as k}from"./trash-2-ClcjC_9b.js";import{u as q,e as _}from"./useExperienceService-Bq8wajk8.js";import{u as K}from"./useAdminCrudForm-BEugt2b5.js";import{A as P,F as m,T as B,a as H,b as R}from"./AdminToolbar-O7s0lh2N.js";import{A as W,L as z}from"./AdminLoadingState-BlNnS30Y.js";import{S as G}from"./square-pen-BtczubbV.js";import"./zodErrorHandler-CM_HDYk9.js";import"./plus-YjYhcHqF.js";function $({onClose:h}){const{t,language:v}=I(),[s,l]=u.useState(v),{experiences:x,isLoading:g,createExperience:j,updateExperience:f,deleteExperience:b}=q({language:s}),{showEditor:N,setShowEditor:y,editingItem:C,formData:r,setFormData:n,errors:d,handleSubmit:E,handleEdit:A,handleDelete:L,resetForm:S}=K({createItem:j,updateItem:f,deleteItem:b,schema:_,initialFormData:{role:"",company:"",period:"",description:"",achievements:[],order_index:0},language:s,confirmDeleteKey:"admin.experience.confirm.delete",deleteErrorKey:"admin.experience.error.deleteFailed",t}),[o,c]=u.useState(""),p=()=>{o.trim()&&!r.achievements?.includes(o.trim())&&(n({...r,achievements:[...r.achievements||[],o.trim()]}),c(""))},F=a=>{n({...r,achievements:r.achievements?.filter(i=>i!==a)||[]})},w=()=>{S(),c("")};return g?e.jsx(W,{}):e.jsxs("div",{children:[e.jsx(P,{title:e.jsx(T,{translationKey:"admin.experience.title",as:"span",shimmerWidth:"230px"}),onClose:h}),N?e.jsxs("form",{onSubmit:E,className:"space-y-4",children:[e.jsx(z,{value:s,onChange:l,label:t("admin.common.language")}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsx(m,{label:t("admin.experience.form.role"),value:r.role,onChange:a=>n({...r,role:a}),error:d.role,required:!0}),e.jsx(m,{label:t("admin.experience.form.company"),value:r.company,onChange:a=>n({...r,company:a}),error:d.company,required:!0})]}),e.jsx(m,{label:t("admin.experience.form.period"),value:r.period,onChange:a=>n({...r,period:a}),error:d.period,placeholder:t("admin.experience.periodPlaceholder"),required:!0}),e.jsx(B,{label:t("admin.common.description"),value:r.description,onChange:a=>n({...r,description:a}),error:d.description,rows:3,required:!0}),e.jsxs("div",{children:[e.jsx("label",{className:"form-label",children:t("admin.experience.form.achievements")}),e.jsxs("div",{className:"flex gap-2 mb-2",children:[e.jsx("input",{type:"text",value:o,onChange:a=>c(a.target.value),onKeyPress:a=>a.key==="Enter"&&(a.preventDefault(),p()),className:"flex-1 field",placeholder:t("admin.experience.form.achievementPlaceholder")}),e.jsx("button",{type:"button",onClick:p,className:"btn btn-primary",children:t("admin.common.add")})]}),e.jsx("div",{className:"space-y-2",children:r.achievements?.map((a,i)=>e.jsxs("div",{className:"flex items-center justify-between p-2 bg-[var(--surface)] rounded-[var(--radius-md)]",children:[e.jsx("span",{className:"text-[var(--text)] text-[length:var(--font-100)]",children:a}),e.jsx("button",{type:"button",onClick:()=>F(a),className:"text-[var(--text-muted)] hover:text-red-400",children:"×"})]},i))})]}),e.jsx(m,{type:"number",label:t("admin.common.orderIndex"),value:r.order_index,onChange:a=>n({...r,order_index:parseInt(a)||0}),min:0}),e.jsx(H,{onCancel:w,submitLabel:t(C?"admin.experience.button.update":"admin.experience.button.create"),cancelLabel:t("admin.common.cancel")})]}):e.jsxs(e.Fragment,{children:[e.jsx(R,{title:t("admin.experience.titleCount"),itemCount:x.length,activeLanguage:s,onLanguageChange:l,onAdd:()=>y(!0),addButtonLabel:t("admin.experience.addExperience")}),e.jsx("div",{className:"space-y-4",children:x.map(a=>e.jsx("div",{className:"p-4 bg-[var(--surface)] rounded-[var(--radius-md)] border border-[var(--border)]",children:e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{className:"flex-1",children:[e.jsxs("h4",{className:"text-[length:var(--font-400)] font-medium text-[var(--text)] mb-2",children:[a.role," ",t("admin.experience.card.at")," ",a.company]}),e.jsx("p",{className:"text-[var(--text-muted)] text-[length:var(--font-100)] mb-2",children:a.period}),e.jsx("p",{className:"text-[var(--text-muted)] mb-3",children:a.description}),e.jsx("div",{className:"space-y-1",children:a.achievements.map((i,D)=>e.jsxs("div",{className:"text-[length:var(--font-100)] text-[var(--text-muted)]",children:["• ",i]},D))}),e.jsxs("div",{className:"text-[length:var(--font-100)] text-[var(--text-muted)] mt-2",children:[t("admin.experience.card.order")," ",a.order_index," | ",t("admin.experience.card.created")," ",new Date(a.created_at).toLocaleDateString()]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("button",{onClick:()=>A(a),className:"p-2 text-[var(--text-muted)] hover:text-[var(--text)] transition-colors",children:e.jsx(G,{className:"h-4 w-4"})}),e.jsx("button",{onClick:()=>L(a.id),className:"p-2 text-[var(--text-muted)] hover:text-red-400 transition-colors",children:e.jsx(k,{className:"h-4 w-4"})})]})]})},a.id))})]})]})}export{$ as ExperienceAdmin};
